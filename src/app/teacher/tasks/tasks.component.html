<div class="task-manager">
  <!-- Header Section -->
  <div class="header">
    <!-- <div class="header-content">
      <div class="icon-wrapper">
        <i class="fas fa-tasks"></i>
      </div>
      <h1>Task Manager</h1>
      <p>Organize your day with style</p>
    </div>
  </div> -->

  <!-- Main Content Grid -->
  <div class="main-grid">
    <!-- Task Form Card -->
    <div class="form-section">
      <div class="glass-card form-card">
        <div class="card-header">
          <h2><i class="fas fa-plus-circle"></i> Create New Task</h2>
          <div class="header-decoration"></div>
        </div>
        
        <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
          <!-- Title Field -->
          <div class="form-group" [class.error]="isFieldInvalid('title')">
            <div class="input-wrapper">
              <i class="fas fa-heading input-icon"></i>
              <input 
                type="text" 
                id="title" 
                formControlName="title" 
                placeholder=" "
                class="form-input">
              <label for="title" class="form-label">Task Title</label>
              <div class="input-border"></div>
            </div>
            <div class="error-message" *ngIf="isFieldInvalid('title')">
              <i class="fas fa-exclamation-circle"></i>
              {{ getErrorMessage('title') }}
            </div>
          </div>

          <!-- Date and Time Row -->
          <div class="form-row">
            <!-- Date Field -->
            <div class="form-group half-width" [class.error]="isFieldInvalid('date')">
              <div class="input-wrapper">
                <i class="fas fa-calendar input-icon"></i>
                <input 
                  type="date" 
                  id="date" 
                  formControlName="date" 
                  class="form-input">
                <label for="date" class="form-label">Date</label>
                <div class="input-border"></div>
              </div>
              <div class="error-message" *ngIf="isFieldInvalid('date')">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage('date') }}
              </div>
            </div>
          </div>

          <!-- Time Row -->
          <div class="form-row">
            <!-- Start Time -->
            <div class="form-group half-width" [class.error]="isFieldInvalid('startTime')">
              <div class="input-wrapper">
                <i class="fas fa-clock input-icon"></i>
                <input 
                  type="time" 
                  id="startTime" 
                  formControlName="startTime" 
                  class="form-input">
                <label for="startTime" class="form-label">Start Time</label>
                <div class="input-border"></div>
              </div>
              <div class="error-message" *ngIf="isFieldInvalid('startTime')">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage('startTime') }}
              </div>
            </div>

            <!-- End Time -->
            <div class="form-group half-width" [class.error]="isFieldInvalid('endTime')">
              <div class="input-wrapper">
                <i class="fas fa-clock input-icon"></i>
                <input 
                  type="time" 
                  id="endTime" 
                  formControlName="endTime" 
                  class="form-input">
                <label for="endTime" class="form-label">End Time</label>
                <div class="input-border"></div>
              </div>
              <div class="error-message" *ngIf="isFieldInvalid('endTime')">
                <i class="fas fa-exclamation-circle"></i>
                {{ getErrorMessage('endTime') }}
              </div>
            </div>
          </div>

          <!-- Time Validation Error -->
          <div class="error-message global-error" *ngIf="taskForm.hasError('timeError')">
            <i class="fas fa-exclamation-triangle"></i>
            End time must be after start time
          </div>

          <!-- Description Field -->
          <div class="form-group" [class.error]="isFieldInvalid('description')">
            <div class="input-wrapper">
              <i class="fas fa-align-left input-icon"></i>
              <textarea 
                id="description" 
                formControlName="description" 
                placeholder=" "
                rows="4"
                class="form-input form-textarea"></textarea>
              <label for="description" class="form-label">Description</label>
              <div class="input-border"></div>
            </div>
            <div class="error-message" *ngIf="isFieldInvalid('description')">
              <i class="fas fa-exclamation-circle"></i>
              {{ getErrorMessage('description') }}
            </div>
          </div>

          <!-- Submit Button -->
          <button 
            type="submit" 
            class="submit-btn"
            [class.loading]="isSubmitting"
            [disabled]="!taskForm.valid || isSubmitting">
            <span class="btn-content" *ngIf="!isSubmitting">
              <i class="fas fa-plus"></i>
              Add Task
            </span>
            <span class="btn-content" *ngIf="isSubmitting">
              <i class="fas fa-spinner fa-spin"></i>
              Adding...
            </span>
            <div class="btn-ripple"></div>
          </button>
        </form>
      </div>
    </div>

    <!-- Tasks List Section -->
    <div class="list-section">
      <div class="glass-card list-card">
        <div class="card-header">
          <h2><i class="fas fa-list-check"></i> Your Tasks</h2>
          <div class="task-stats">
            <span class="task-count">{{ tasks.length }} task{{ tasks.length !== 1 ? 's' : '' }}</span>
            <span class="completion-rate" *ngIf="tasks.length > 0">
              {{ getCompletionRate() }}% complete
            </span>
          </div>
        </div>

        <!-- Filter and Sort Controls -->
        <div class="controls-bar" *ngIf="tasks.length > 0">
          <div class="filter-group">
            <button 
              class="filter-btn"
              [class.active]="currentFilter === 'all'"
              (click)="setFilter('all')">
              All
            </button>
            <button 
              class="filter-btn"
              [class.active]="currentFilter === 'pending'"
              (click)="setFilter('pending')">
              Pending
            </button>
            <button 
              class="filter-btn"
              [class.active]="currentFilter === 'completed'"
              (click)="setFilter('completed')">
              Completed
            </button>
          </div>
          <div class="sort-group">
            <select class="sort-select" [(ngModel)]="sortBy" (change)="sortTasks()">
              <option value="date">Sort by Date</option>
              <option value="title">Sort by Title</option>
            </select>
          </div>
        </div>

        <!-- Tasks List -->
        <div class="tasks-container">
          <div class="task-item" 
               *ngFor="let task of getFilteredTasks(); let i = index; trackBy: trackByTask"
               [class.completed]="task.completed"
               [@taskAnimation]>
            
            <div class="task-checkbox">
              <input 
                type="checkbox" 
                [id]="'task-' + i"
                [checked]="task.completed"
                (change)="toggleTask(getOriginalIndex(task))">
              <label [for]="'task-' + i" class="checkbox-label">
                <i class="fas fa-check"></i>
              </label>
            </div>

            <div class="task-content">
              <div class="task-header">
                <h3 class="task-title">{{ task.title }}</h3>
                <div class="task-meta">
                  <span class="day-badge">{{ task.day }}</span>
                </div>
              </div>
              
              <p class="task-description">{{ task.description }}</p>
              
              <div class="task-details">
                <div class="detail-item">
                  <i class="fas fa-calendar"></i>
                  {{ task.date | date:'mediumDate' }}
                </div>
                <div class="detail-item">
                  <i class="fas fa-clock"></i>
                  {{ task.startTime }} - {{ task.endTime }}
                </div>
                <div class="detail-item duration">
                  <i class="fas fa-hourglass-half"></i>
                  {{ calculateDuration(task.startTime, task.endTime) }}
                </div>
              </div>
            </div>

            <div class="task-actions">
              <button 
                class="action-btn complete-btn"
                (click)="toggleTask(getOriginalIndex(task))"
                [class.completed]="task.completed"
                title="Toggle Complete">
                <i class="fas" [class.fa-check-circle]="task.completed" [class.fa-circle]="!task.completed"></i>
              </button>
              <button 
                class="action-btn edit-btn"
                (click)="editTask(getOriginalIndex(task))"
                title="Edit Task">
                <i class="fas fa-edit"></i>
              </button>
              <button 
                class="action-btn delete-btn"
                (click)="deleteTask(getOriginalIndex(task))"
                title="Delete Task">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>

          <!-- Empty State -->
          <div class="empty-state" *ngIf="getFilteredTasks().length === 0">
            <div class="empty-icon">
              <i class="fas fa-clipboard-list"></i>
            </div>
            <h3>{{ getEmptyStateTitle() }}</h3>
            <p>{{ getEmptyStateMessage() }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Message -->
  <div class="toast" [class.show]="showToast" [@slideUp]>
    <div class="toast-content">
      <i class="fas fa-check-circle"></i>
      {{ toastMessage }}
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-overlay" *ngIf="showDeleteModal" [@fadeIn] (click)="cancelDelete()">
    <div class="modal" (click)="$event.stopPropagation()" [@modalSlide]>
      <div class="modal-header">
        <h3>Confirm Delete</h3>
        <button class="close-btn" (click)="cancelDelete()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this task? This action cannot be undone.</p>
      </div>
      <div class="modal-actions">
        <button class="btn secondary" (click)="cancelDelete()">Cancel</button>
        <button class="btn danger" (click)="confirmDelete()">
          <i class="fas fa-trash"></i>
          Delete
        </button>
      </div>
    </div>
  </div>
</div>